{"ast":null,"code":"var _jsxFileName = \"/Users/apple/Dropbox/My Mac (zaytsev.local)/Documents/mapbox/src/Mapbox.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport ReactMapGL, { Marker, Popup } from 'react-map-gl';\nimport { showAuthWindow } from './actions/userActions';\nimport { BrowserRouter as Router, Switch, Route, Link, useParams } from \"react-router-dom\";\nimport ImageView from './components/ImageView';\nimport AddBox from './components/AddBox';\nimport User from './components/User';\nimport Processing from './components/Processing';\nimport Direction from './components/Direction';\nimport Clock from './components/Clock';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { userLogin, userLogout } from './actions/userActions';\n\nconst Mapbox = props => {\n  console.log(\"imfather\");\n  let {\n    id\n  } = useParams();\n  const [logEntries, setLogEntries] = useState([]);\n  const [showPopup, setShowPopup] = useState({});\n  const [isShown, setShow] = useState(id ? parseInt(id) : 0);\n  const [isAdd, setAdd] = useState(false);\n  const [point, setPoint] = useState(false);\n  const [pos, setPos] = useState({});\n  const [user, setUser] = useState(false);\n  const [load, setLoad] = useState(false);\n  const [logged, setLogged] = useState({});\n  const [hint, setHint] = useState(false);\n  const [viewport, setViewport] = useState({\n    width: '100vw',\n    height: '100vh',\n    latitude: 10.7781128,\n    longitude: 106.65325,\n    zoom: 12\n  });\n\n  const getLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(showPosition);\n    } else {\n      alert(\"Geolocation is not supported by this browser.\");\n    }\n  };\n\n  const showPosition = position => {\n    setViewport({\n      width: '100vw',\n      height: '100vh',\n      latitude: position.coords.latitude,\n      longitude: position.coords.longitude,\n      zoom: 12\n    });\n  };\n\n  const getUser = () => {\n    console.log(\"in getUser()\");\n    fetch(\"http://localhost:3000/auth/login/success\", {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Credentials\": true\n      }\n    }).then(response => {\n      console.log(\"in then1\");\n      getEntries();\n      if (response.status === 200) return response.json();\n      throw new Error(\"failed to authenticate user\");\n    }).then(responseJson => {\n      setLogged(responseJson.user);\n      setUser(true);\n    }).catch(error => {\n      setLogged(false);\n    });\n  };\n\n  const getEntries = async () => {\n    const response = await fetch('http://localhost:3000/api/logs');\n    const result = await response.json(); // setLogEntries(result)\n\n    console.log(result);\n    setLogEntries(result);\n    setLoad(true); //setUser(result)\n  };\n\n  useEffect(() => {\n    if (window.location.hash === \"#_=_\") {\n      window.history.replaceState ? window.history.replaceState(null, null, window.location.href.split(\"#\")[0]) : window.location.hash = \"\";\n    } // getUser()\n\n\n    props.userLogin();\n    getEntries();\n    setUser(true); // console.log(props.user_info);\n  }, []);\n\n  const onClick = e => {\n    const newVewport = { ...viewport,\n      latitude: e.lngLat[1],\n      longitude: e.lngLat[0]\n    };\n    setPos({\n      lng: e.lngLat[0],\n      lat: e.lngLat[1]\n    });\n    console.log(isAdd);\n    if (isAdd) setPoint(true);\n    setViewport(newVewport);\n  };\n\n  const onDblClick = e => {\n    console.log('A click event has occurred at ' + e.lngLat[0]);\n  };\n\n  const PlusIcon = ({\n    handleClick,\n    value\n  }) => {\n    const divStyle = {\n      position: 'absolute',\n      margin: '15px 15px',\n      zIndex: '500'\n    };\n    const divStyle1 = {\n      position: 'absolute',\n      margin: '10px 15px',\n      zIndex: '500',\n      animation: 'App-logo-spin 0s',\n      animationFillMode: 'forwards'\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: value ? divStyle1 : divStyle,\n      onClick: () => handleClick(!value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"svg\", {\n      className: \"marker white\",\n      style: {\n        height: `${3 * 12}px`,\n        width: `${3 * 12}px`\n      },\n      version: \"1.1\",\n      id: \"Layer_1\",\n      x: \"0px\",\n      y: \"0px\",\n      viewBox: \"0 0 512 512\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"g\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"g\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"path\", {\n      style: {\n        fill: 'white'\n      },\n      d: \"m272 184c-4.417969 0-8-3.582031-8-8v-176h-80v176c0 4.417969-3.582031 8-8 8h-176v80h176c4.417969 0 8 3.582031 8 8v176h80v-176c0-4.417969 3.582031-8 8-8h176v-80zm0 0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 15\n      }\n    })))));\n  };\n\n  const Point = ({\n    pos\n  }) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        position: 'absolute',\n        padding: '2px 7px',\n        height: '15px',\n        lineHeight: '15px',\n        borderRadius: '3px',\n        backgroundColor: 'white',\n        color: 'black',\n        top: '2%',\n        left: '5%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 7\n      }\n    }, pos.lng.toFixed(6), \" - \", pos.lat.toFixed(6));\n  };\n\n  return /*#__PURE__*/React.createElement(ReactMapGL, Object.assign({\n    mapStyle: \"mapbox://styles/thecjreynolds/ck117fnjy0ff61cnsclwimyay\",\n    mapboxApiAccessToken: 'pk.eyJ1IjoiemF5dHNldjUiLCJhIjoiY2tjaWk4cnc2MGtiMDJxazJwMGllOThlNyJ9.HciILC1tn3zdsXCuvzdRog',\n    onViewportChange: setViewport,\n    doubleClickZoom: false,\n    onDblClick: onClick,\n    scrollZoom: isShown ? false : true,\n    onClick: e => onDblClick(e)\n  }, viewport, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PlusIcon, {\n    handleClick: val => setAdd(val),\n    value: isAdd,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 9\n    }\n  }), isAdd && /*#__PURE__*/React.createElement(AddBox, {\n    reload: () => getEntries(),\n    logged: Object.keys(props.user_info).length > 0 ? true : false,\n    name: props.user_info.displayName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 20\n    }\n  })), /*#__PURE__*/React.createElement(React.Fragment, null, point && /*#__PURE__*/React.createElement(Point, {\n    pos: pos,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 20\n    }\n  })), !load && /*#__PURE__*/React.createElement(Processing, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 18\n    }\n  }), logEntries.map(entry => /*#__PURE__*/React.createElement(React.Fragment, {\n    key: entry.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Marker, {\n    latitude: entry.latitude,\n    longitude: entry.longitude,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onClick: () => setShowPopup(entry.id),\n    style: {\n      cursor: 'pointer'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"marker white\",\n    style: {\n      height: `${3 * viewport.zoom}px`,\n      width: `${3 * viewport.zoom}px`,\n      cursor: 'pointer'\n    },\n    version: \"1.1\",\n    id: \"Layer_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512 512\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: 'white'\n    },\n    d: \"M184.08,0c-74.992,0-136,61.008-136,136c0,24.688,11.072,51.24,11.536,52.36c3.576,8.488,10.632,21.672,15.72,29.4 l93.248,141.288c3.816,5.792,9.464,9.112,15.496,9.112s11.68-3.32,15.496-9.104l93.256-141.296 c5.096-7.728,12.144-20.912,15.72-29.4c0.464-1.112,11.528-27.664,11.528-52.36C320.08,61.008,259.072,0,184.08,0z M293.8,182.152c-3.192,7.608-9.76,19.872-14.328,26.8l-93.256,141.296c-1.84,2.792-2.424,2.792-4.264,0L88.696,208.952 c-4.568-6.928-11.136-19.2-14.328-26.808C74.232,181.816,64.08,157.376,64.08,136c0-66.168,53.832-120,120-120 c66.168,0,120,53.832,120,120C304.08,157.408,293.904,181.912,293.8,182.152z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      fill: 'white'\n    },\n    d: \"M184.08,64.008c-39.704,0-72,32.304-72,72c0,39.696,32.296,72,72,72c39.704,0,72-32.304,72-72 C256.08,96.312,223.784,64.008,184.08,64.008z M184.08,192.008c-30.872,0-56-25.12-56-56s25.128-56,56-56s56,25.12,56,56 S214.952,192.008,184.08,192.008z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 23\n    }\n  })))))), showPopup == entry.id ? /*#__PURE__*/React.createElement(Popup, {\n    className: \"mu-popup\",\n    latitude: entry.latitude,\n    longitude: entry.longitude,\n    closeButton: true,\n    closeOnClick: false,\n    dynamicPosition: true,\n    onClose: () => setShowPopup({}),\n    anchor: \"top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"asdsa-apopup\",\n    style: {\n      width: '210px',\n      fontSize: '12px',\n      zIndex: '99',\n      position: 'relative',\n      zIndex: '300'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 21\n    }\n  }, entry.title), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    style: {\n      fontSize: '15px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 24\n    }\n  }, entry.comments)), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 24\n    }\n  }, \"Author\"), \" - \", entry.author), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 24\n    }\n  }, \"Visited on:\"), \" \", new Date(entry.visitDate).toLocaleDateString()), entry.image && /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/log/${entry.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    onClick: () => setShow(entry.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 27\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: entry.image,\n    alt: entry.title,\n    width: \"210px\",\n    height: \"100px\",\n    title: \"Zoom in\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 64\n    }\n  })))), entry.image && /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `${entry.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 25\n    }\n  })))) : null, isShown == entry.id ? /*#__PURE__*/React.createElement(ImageView, {\n    src: entry.image,\n    id: entry.id,\n    uid: props.user_info.id || '',\n    name: props.user_info.displayName || '',\n    log: entry,\n    offShow: val => setShow(val),\n    url: Object.keys(props.user_info).length > 0 ? props.user_info.photos[0].value : '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 17\n    }\n  }) : null, Object.keys(props.user_info).length > 0 ? /*#__PURE__*/React.createElement(User, {\n    url: props.user_info.photos[0].value,\n    userName: props.user_info.displayName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 57\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    href: \"http://localhost:3000/auth/facebook\",\n    style: {\n      position: 'absolute',\n      padding: '5px 10px',\n      lineHeight: '25px',\n      borderRadius: '3px',\n      backgroundColor: 'white',\n      color: 'black',\n      bottom: '5%',\n      left: '5%',\n      textDecoration: 'none',\n      color: '#4267b2',\n      fontWeight: '700'\n    },\n    onClick: () => {\n      showAuthWindow({\n        path: \"http://localhost:3000/auth/facebook\",\n        callback: function () {\n          window.location.reload();\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 17\n    }\n  }, \"Login with facebook\")), /*#__PURE__*/React.createElement(\"div\", {\n    onClick: () => setHint(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    href: \"http://localhost:3000/auth/facebook\",\n    style: {\n      position: 'absolute',\n      padding: '1px 10px',\n      lineHeight: '25px',\n      borderRadius: '50%',\n      backgroundColor: 'white',\n      color: 'black',\n      bottom: '3%',\n      left: '1%',\n      textDecoration: 'none',\n      color: '#4267b2'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 15\n    }\n  }, \"?\")), hint && /*#__PURE__*/React.createElement(Direction, {\n    off: val => setHint(val),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 22\n    }\n  }), /*#__PURE__*/React.createElement(Clock, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 13\n    }\n  }))));\n};\n\nMapbox.propTypes = {\n  userLogin: PropTypes.func.isRequired,\n  userLogout: PropTypes.func.isRequired,\n  user_info: PropTypes.object // newPost: PropTypes.object\n\n};\n\nconst mapStateToProps = state => ({\n  user_info: state.data.user,\n  message: state.data.message\n});\n\nexport default connect(mapStateToProps, {\n  userLogin,\n  userLogout\n})(Mapbox);","map":{"version":3,"sources":["/Users/apple/Dropbox/My Mac (zaytsev.local)/Documents/mapbox/src/Mapbox.js"],"names":["React","useState","useEffect","useRef","ReactMapGL","Marker","Popup","showAuthWindow","BrowserRouter","Router","Switch","Route","Link","useParams","ImageView","AddBox","User","Processing","Direction","Clock","PropTypes","connect","userLogin","userLogout","Mapbox","props","console","log","id","logEntries","setLogEntries","showPopup","setShowPopup","isShown","setShow","parseInt","isAdd","setAdd","point","setPoint","pos","setPos","user","setUser","load","setLoad","logged","setLogged","hint","setHint","viewport","setViewport","width","height","latitude","longitude","zoom","getLocation","navigator","geolocation","getCurrentPosition","showPosition","alert","position","coords","getUser","fetch","method","credentials","headers","Accept","then","response","getEntries","status","json","Error","responseJson","catch","error","result","window","location","hash","history","replaceState","href","split","onClick","e","newVewport","lngLat","lng","lat","onDblClick","PlusIcon","handleClick","value","divStyle","margin","zIndex","divStyle1","animation","animationFillMode","fill","Point","padding","lineHeight","borderRadius","backgroundColor","color","top","left","toFixed","val","Object","keys","user_info","length","displayName","map","entry","cursor","fontSize","title","comments","author","Date","visitDate","toLocaleDateString","image","photos","bottom","textDecoration","fontWeight","path","callback","reload","propTypes","func","isRequired","object","mapStateToProps","state","data","message"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport ReactMapGL, { Marker, Popup } from 'react-map-gl';\nimport { showAuthWindow } from './actions/userActions'\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useParams\n} from \"react-router-dom\";\nimport ImageView from './components/ImageView';\nimport AddBox from './components/AddBox'\nimport User from './components/User'\nimport Processing from './components/Processing'\nimport Direction from './components/Direction'\nimport Clock from './components/Clock'\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { userLogin, userLogout } from './actions/userActions';\n\n\n\n\n\n\nconst Mapbox = (props) => {\nconsole.log(\"imfather\");\n  let { id } = useParams()\n  const [logEntries, setLogEntries] = useState([]);\n  const [showPopup, setShowPopup] = useState({});\n  const [isShown, setShow] = useState(id ? parseInt(id) : 0)\n  const [isAdd, setAdd] = useState(false)\n  const [point, setPoint] = useState(false)\n  const [pos, setPos] = useState({})\n  const [user, setUser] = useState(false)\n  const [load, setLoad] = useState(false)\n  const [logged, setLogged] = useState({})\n  const [hint, setHint] = useState(false)\n\n\n  const [viewport, setViewport] = useState({\n    width: '100vw',\n    height: '100vh',\n    latitude: 10.7781128,\n    longitude: 106.65325,\n    zoom: 12\n  });\n\n  const getLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(showPosition);\n    } else {\n      alert(\"Geolocation is not supported by this browser.\")\n    }\n  }\n\n  const showPosition = (position) => {\n    setViewport({\n      width: '100vw',\n      height: '100vh',\n      latitude: position.coords.latitude,\n      longitude: position.coords.longitude,\n      zoom: 12\n    })\n  }\n\n  const getUser = () => {\n    console.log(\"in getUser()\");\n    fetch(\"http://localhost:3000/auth/login/success\", {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Credentials\": true\n      }\n    })\n      .then(response => {\n        console.log(\"in then1\");\n\n        getEntries()\n        if (response.status === 200) return response.json();\n        throw new Error(\"failed to authenticate user\");\n      })\n      .then(responseJson => {\n        setLogged(responseJson.user)\n        setUser(true)\n\n      })\n      .catch(error => {\n        setLogged(false)\n\n      });\n\n  }\n\n  const getEntries = async () => {\n    const response = await fetch('http://localhost:3000/api/logs')\n    const result = await response.json()\n    // setLogEntries(result)\n    console.log(result);\n    setLogEntries(result);\n    setLoad(true)\n    //setUser(result)\n\n  };\n\n\n\n\n\n\n  useEffect(() => {\n    if (window.location.hash === \"#_=_\") {\n      window.history.replaceState\n        ? window.history.replaceState(null, null, window.location.href.split(\"#\")[0])\n        : window.location.hash = \"\";\n    }\n\n    // getUser()\n    props.userLogin()\n    getEntries()\n    setUser(true)\n    // console.log(props.user_info);\n  }, []);\n\n  const onClick = (e) => {\n    const newVewport = {\n      ...viewport,\n      latitude: e.lngLat[1],\n      longitude: e.lngLat[0]\n    };\n    setPos({ lng: e.lngLat[0], lat: e.lngLat[1] })\n    console.log(isAdd);\n    if (isAdd) setPoint(true)\n\n    setViewport(newVewport);\n  };\n\n  const onDblClick = e => {\n    console.log('A click event has occurred at ' + e.lngLat[0]);\n  };\n\n  const PlusIcon = ({ handleClick, value }) => {\n\n    const divStyle = {\n      position: 'absolute',\n      margin: '15px 15px',\n      zIndex: '500',\n\n    }\n    const divStyle1 = {\n      position: 'absolute',\n      margin: '10px 15px',\n      zIndex: '500',\n      animation: 'App-logo-spin 0s',\n      animationFillMode: 'forwards',\n    }\n    return (\n      <div style={value ? divStyle1 : divStyle} onClick={() => handleClick(!value)}>\n        <svg\n          className=\"marker white\"\n          style={{\n            height: `${3 * 12}px`,\n            width: `${3 * 12}px`,\n          }}\n          version=\"1.1\" id=\"Layer_1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\">\n          <g>\n            <g>\n              <path style={{ fill: 'white' }} d=\"m272 184c-4.417969 0-8-3.582031-8-8v-176h-80v176c0 4.417969-3.582031 8-8 8h-176v80h176c4.417969 0 8 3.582031 8 8v176h80v-176c0-4.417969 3.582031-8 8-8h176v-80zm0 0\" />\n            </g>\n          </g>\n        </svg>\n      </div>\n    )\n  }\n  const Point = ({ pos }) => {\n\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          padding: '2px 7px',\n          height: '15px',\n          lineHeight: '15px',\n          borderRadius: '3px',\n          backgroundColor: 'white',\n          color: 'black',\n          top: '2%',\n          left: '5%',\n\n        }}>\n\n        {pos.lng.toFixed(6)} - {pos.lat.toFixed(6)}\n      </div>\n    )\n  }\n\n  return (\n    <ReactMapGL\n\n      mapStyle=\"mapbox://styles/thecjreynolds/ck117fnjy0ff61cnsclwimyay\"\n\n      mapboxApiAccessToken={'pk.eyJ1IjoiemF5dHNldjUiLCJhIjoiY2tjaWk4cnc2MGtiMDJxazJwMGllOThlNyJ9.HciILC1tn3zdsXCuvzdRog'}\n      onViewportChange={setViewport}\n      doubleClickZoom={false}\n      onDblClick={onClick}\n      scrollZoom={isShown ? false : true}\n      onClick={(e) => onDblClick(e)}\n      {...viewport}\n    >\n\n      <>\n        <PlusIcon handleClick={(val) => setAdd(val)} value={isAdd} />\n        {\n          isAdd && <AddBox reload={() => getEntries()} logged={Object.keys(props.user_info).length > 0 ? true : false} name={props.user_info.displayName} />\n        }\n\n      </>\n      <>\n        {\n          point && <Point pos={pos} />\n        }\n      </>\n\n      {\n        !load && <Processing />\n      }\n      {\n        logEntries.map(entry => (\n          <React.Fragment key={entry.id}>\n            <Marker\n              latitude={entry.latitude}\n              longitude={entry.longitude}\n            >\n              <div\n\n                onClick={() => setShowPopup(entry.id)}\n                style={{\n\n                  cursor: 'pointer'\n                }}\n              >\n                <svg\n                  className=\"marker white\"\n                  style={{\n                    height: `${3 * viewport.zoom}px`,\n                    width: `${3 * viewport.zoom}px`,\n                    cursor: 'pointer'\n                  }}\n                  version=\"1.1\" id=\"Layer_1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\">\n                  <g>\n                    <g>\n                      <path style={{ fill: 'white' }} d=\"M184.08,0c-74.992,0-136,61.008-136,136c0,24.688,11.072,51.24,11.536,52.36c3.576,8.488,10.632,21.672,15.72,29.4\n                        l93.248,141.288c3.816,5.792,9.464,9.112,15.496,9.112s11.68-3.32,15.496-9.104l93.256-141.296\n                        c5.096-7.728,12.144-20.912,15.72-29.4c0.464-1.112,11.528-27.664,11.528-52.36C320.08,61.008,259.072,0,184.08,0z\n                        M293.8,182.152c-3.192,7.608-9.76,19.872-14.328,26.8l-93.256,141.296c-1.84,2.792-2.424,2.792-4.264,0L88.696,208.952\n                        c-4.568-6.928-11.136-19.2-14.328-26.808C74.232,181.816,64.08,157.376,64.08,136c0-66.168,53.832-120,120-120\n                        c66.168,0,120,53.832,120,120C304.08,157.408,293.904,181.912,293.8,182.152z\"/>\n                      <path style={{ fill: 'white' }} d=\"M184.08,64.008c-39.704,0-72,32.304-72,72c0,39.696,32.296,72,72,72c39.704,0,72-32.304,72-72\n                        C256.08,96.312,223.784,64.008,184.08,64.008z M184.08,192.008c-30.872,0-56-25.12-56-56s25.128-56,56-56s56,25.12,56,56\n                        S214.952,192.008,184.08,192.008z\"/>\n                    </g>\n                  </g>\n                </svg>\n              </div>\n            </Marker>\n            {\n              showPopup == entry.id ? (\n                <Popup\n                  className=\"mu-popup\"\n                  latitude={entry.latitude}\n                  longitude={entry.longitude}\n                  closeButton={true}\n                  closeOnClick={false}\n                  dynamicPosition={true}\n                  onClose={() => setShowPopup({})}\n                  anchor=\"top\" >\n                  <div className=\"asdsa-apopup\" style={{ width: '210px', fontSize: '12px', zIndex: '99', position: 'relative', zIndex: '300' }}>\n                    <h2>{entry.title}</h2>\n                    <p><strong style={{ fontSize: '15px' }}>{entry.comments}</strong></p>\n                    <p><strong>Author</strong> - {entry.author}</p>\n                    <p><strong>Visited on:</strong> {new Date(entry.visitDate).toLocaleDateString()}</p>\n                    {\n                      entry.image &&\n                      <Router>\n                        <Link to={`/log/${entry.id}`}>\n\n                          <p onClick={() => setShow(entry.id)}><img\n                            src={entry.image}\n                            alt={entry.title}\n                            width='210px' height='100px'\n                            title=\"Zoom in\"\n                          />\n                          </p>\n                        </Link>\n                      </Router>\n                    }\n                    {entry.image &&\n                      <Router>\n                        <Link to={`${entry.id}`}>\n                        </Link>\n                      </Router>\n\n                    }\n                  </div>\n                </Popup>\n              ) : null\n            }\n            {\n              isShown == entry.id ? (\n                <ImageView\n                  src={entry.image}\n                  id={entry.id}\n                  uid={props.user_info.id || ''}\n                  name={props.user_info.displayName || ''}\n                  log={entry}\n                  offShow={(val) => setShow(val)}\n                  url={Object.keys(props.user_info).length > 0 ? props.user_info.photos[0].value : ''} />\n              ) : null\n            }\n            { Object.keys(props.user_info).length > 0 ? <User url={props.user_info.photos[0].value} userName={props.user_info.displayName} /> :\n              <div className=\"login\">\n                < div\n                  href='http://localhost:3000/auth/facebook'\n                  style={{\n                    position: 'absolute',\n                    padding: '5px 10px',\n                    lineHeight: '25px',\n                    borderRadius: '3px',\n                    backgroundColor: 'white',\n                    color: 'black',\n                    bottom: '5%',\n                    left: '5%',\n                    textDecoration: 'none',\n                    color: '#4267b2',\n                    fontWeight: '700'\n\n                  }}\n                  onClick={() => {\n                    showAuthWindow({\n                      path: \"http://localhost:3000/auth/facebook\",\n                      callback: function () {\n\n                        window.location.reload()\n                      }\n                    })\n                  }}\n\n                >Login with facebook</div>\n              </div>\n            }\n            <div onClick={() => setHint(true)} >\n              <p\n                href='http://localhost:3000/auth/facebook'\n                style={{\n                  position: 'absolute',\n                  padding: '1px 10px',\n\n                  lineHeight: '25px',\n                  borderRadius: '50%',\n                  backgroundColor: 'white',\n                  color: 'black',\n                  bottom: '3%',\n                  left: '1%',\n                  textDecoration: 'none',\n                  color: '#4267b2'\n                }}\n              >\n                ?\n                </p>\n            </div>\n            {hint && <Direction off={(val) => setHint(val)} />}\n            <Clock />\n          </React.Fragment>\n        ))\n      }\n\n    </ReactMapGL>\n\n  );\n}\n\nMapbox.propTypes = {\n  userLogin: PropTypes.func.isRequired,\n  userLogout: PropTypes.func.isRequired,\n  user_info: PropTypes.object,\n  // newPost: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  user_info: state.data.user,\n  message: state.data.message\n});\nexport default connect(mapStateToProps, { userLogin, userLogout })(Mapbox);"]},"metadata":{},"sourceType":"module"}